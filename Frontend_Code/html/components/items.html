<!--
  Consumables - Items Management Page

-->

<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>CARES | Items Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&amp;display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/Frontend_Code/css/admin.css" />
</head>

<body class="bg-[#f3f7f7] min-h-screen">
  <!-- Loading Spinner -->
  <div id="loadingSpinner" class="fixed inset-0 z-50 flex items-center justify-center bg-[#f3f7f7]">
    <div class="flex flex-col items-center p-8 bg-white rounded-lg shadow-lg">
      <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#2ca14a]"></div>
      <p class="mt-4 text-lg font-medium text-gray-700">Loading CARES System</p>
      <p class="mt-2 text-sm text-gray-500">Please wait while we prepare everything for you...</p>
    </div>
  </div>

  <!-- Table Loading State -->
  <div id="tableLoadingState" class="hidden">
    <div class="p-4 space-y-4 animate-pulse">
      <!-- Header shimmer -->
      <div class="w-1/4 h-8 bg-gray-200 rounded"></div>
      <!-- Table header shimmer -->
      <div class="h-12 mb-4 bg-gray-200 rounded"></div>
      <!-- Table rows shimmer -->
      <div class="space-y-3">
        <div class="h-10 bg-gray-200 rounded"></div>
        <div class="h-10 bg-gray-200 rounded opacity-75"></div>
        <div class="h-10 bg-gray-200 rounded opacity-50"></div>
        <div class="h-10 bg-gray-200 rounded opacity-75"></div>
        <div class="h-10 bg-gray-200 rounded opacity-50"></div>
      </div>
      <!-- Loading message -->
      <div class="flex items-center justify-center mt-6">
        <p class="text-sm text-gray-500">Loading items data...</p>
      </div>
    </div>
  </div>

  <nav class="flex items-center justify-between px-4 md:px-8 lg:px-12 h-20 border-b border-gray-300 bg-[#f3f7f7]">
    <!-- Left side: Logo and Title -->
    <a href="/Frontend_Code/html/dashboard.html" class="flex items-center space-x-3 group">
      <img alt="CAS Lab logo with green and yellow colors, circular emblem with text"
        class="object-contain w-12 h-12 transition-transform" height="48" src="/Frontend_Code/images/cas_logo.png"
        width="48" />
      <div class="flex flex-col leading-tight">
        <span class="text-sm font-semibold text-black"> CARES. </span>
        <span class="text-[9px] font-semibold text-black/80 tracking-tight">
          CENTRALIZED RESOURCE
        </span>
        <span class="text-[9px] font-semibold text-black/80 tracking-tight">
          AND EQUIPMENT SYSTEM
        </span>
      </div>
      <div class="h-10 ml-4 border-l border-black/40"></div>
    </a>
    <!-- Right side: Navigation Links -->
    <ul class="flex space-x-8 text-[13px] font-normal text-black">
      <li>
        <a class="pb-1 border-b-2 border-transparent hover:border-[#2ca14a] hover:text-[#2ca14a]"
          href="/Frontend_Code/html/dashboard.html">
          Dashboard
        </a>
      </li>
      <li class="relative">
        <button aria-expanded="false" aria-haspopup="true"
          class="inline-flex items-center cursor-pointer select-none focus:outline-none" id="masterlistBtn"
          type="button">
          Masterlist
          <i class="ml-1 text-xs fas fa-chevron-down"> </i>
        </button>
        <ul aria-labelledby="masterlistBtn"
          class="absolute left-0 z-10 invisible mt-1 transition-opacity bg-white border border-gray-300 rounded shadow-md opacity-0 top-full w-36"
          id="masterlistMenu" role="menu">
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/admins.html" role="menuitem" tabindex="-1">
              Admins
            </a>
          </li>
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/inventory.html" role="menuitem" tabindex="-1">
              Inventory
            </a>
          </li>
        </ul>
      </li>
      <li class="relative">
        <button aria-expanded="false" aria-haspopup="true"
          class="inline-flex items-center font-semibold pb-1 border-b-2 border-[#2ca14a] text-[#2ca14a] cursor-pointer select-none focus:outline-none"
          id="consumablesBtn" type="button">
          Consumables
          <i class="ml-1 text-xs fas fa-chevron-down"> </i>
        </button>
        <ul aria-labelledby="consumablesBtn"
          class="absolute left-0 z-10 invisible mt-1 transition-opacity bg-white border border-gray-300 rounded shadow-md opacity-0 top-full w-36"
          id="consumablesMenu" role="menu">
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/chemicals.html" role="menuitem" tabindex="-1">
              Chemicals
            </a>
          </li>
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/items.html" role="menuitem" tabindex="-1">
              Items
            </a>
          </li>
        </ul>
      </li>
      <li class="relative">
        <button aria-expanded="false" aria-haspopup="true"
          class="inline-flex items-center cursor-pointer select-none focus:outline-none" id="nonconsumablesBtn"
          type="button">
          Non-consumables
          <i class="ml-1 text-xs text-black fas fa-chevron-down"> </i>
        </button>
        <ul aria-labelledby="nonconsumablesBtn"
          class="absolute left-0 z-10 invisible mt-1 transition-opacity bg-white border border-gray-300 rounded shadow-md opacity-0 top-full w-44"
          id="nonconsumablesMenu" role="menu">
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/equipments.html" role="menuitem" tabindex="-1">
              Equipment
            </a>
          </li>
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/apparatus.html" role="menuitem" tabindex="-1">
              Apparatus
            </a>
          </li>
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/glassware.html" role="menuitem" tabindex="-1">
              Glassware
            </a>
          </li>
        </ul>
      </li>
      <li class="relative">
        <button aria-expanded="false" aria-haspopup="true"
          class="inline-flex items-center cursor-pointer select-none focus:outline-none" id="propertiesBtn"
          type="button">
          Properties
          <i class="ml-1 text-xs text-black fas fa-chevron-down"> </i>
        </button>
        <ul aria-labelledby="propertiesBtn"
          class="absolute left-0 z-10 invisible w-40 mt-1 transition-opacity bg-white border border-gray-300 rounded shadow-md opacity-0 top-full"
          id="propertiesMenu" role="menu">
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/unitType.html" role="menuitem" tabindex="-1">
              Unit Type
            </a>
          </li>
          <li role="none">
            <a class="block px-4 py-2 text-sm text-black hover:bg-[#2ca14a] hover:text-white"
              href="/Frontend_Code/html/components/location.html" role="menuitem" tabindex="-1">
              Location
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a class="pb-1 border-b-2 border-transparent hover:border-[#2ca14a] hover:text-[#2ca14a]"
          href="/Frontend_Code/html/components/restocks.html">
          Restocks
        </a>
      </li>
      <li>
        <a class="pb-1 border-b-2 border-transparent hover:border-[#2ca14a] hover:text-[#2ca14a]"
          href="/Frontend_Code/html/components/transactions.html">
          Transactions
        </a>
      </li>
      <li>
        <a class="pb-1 border-b-2 border-transparent hover:border-[#2ca14a] hover:text-[#2ca14a]"
          href="/Frontend_Code/html/components/statistics.html">
          Statistics
        </a>
      </li>
    </ul>
  </nav>
  <main class="max-w-full px-4 mx-auto mt-6 sm:px-6 lg:px-12">
    <div class="flex flex-col items-center justify-between w-full gap-3 sm:flex-row sm:gap-0">
      <div class="flex flex-col items-center w-full gap-3 sm:flex-row sm:gap-4 sm:w-auto">
        <input id="searchInput" aria-label="Search"
          class="rounded-md border border-gray-300 bg-white py-2 px-3 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent max-w-xs w-full sm:w-64"
          placeholder="Search..." type="search" />
      </div>
      <button aria-controls="addConsumableItemModal" aria-haspopup="dialog" class="custom-btn"
        id="addConsumableItemsBtn" type="button">
        Add Item
      </button>
    </div>
    <div class="flex items-center justify-between mt-4 mb-3">
      <h2 class="text-sm font-semibold text-gray-900">Consumables - Items</h2>
      <button id="downloadPdfBtn"
        class="px-1.5 py-1.5 border border-green-600 text-green-700 bg-white rounded-lg hover:bg-green-50 font-medium text-sm shadow-sm transition">
        Download PDF Report
      </button>
    </div>
    <div class="overflow-x-auto bg-white border border-gray-100 rounded-md">
      <table class="min-w-full text-sm divide-y divide-gray-200">
        <thead class="sticky top-0 z-10 bg-gray-50">
          <tr>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Item ID
            </th>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Name
            </th>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Unit
            </th>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Location
            </th>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Brand
            </th>
            <th class="px-6 py-3 font-semibold text-left text-gray-900 border-b border-gray-200" scope="col">
              Quantity
            </th>
          </tr>
        </thead>
        <tbody id="consumableItemsTablebody" class="bg-white divide-y divide-gray-200">
          <!-- This is just for the table body -->
          <!-- Example row will be added dynamically through CRUD -->
        </tbody>
      </table>
    </div>
  </main>

  <!-- Edit Items Modal -->
  <div aria-labelledby="editModalTitle" aria-modal="true" class="fixed inset-0 z-50 items-center justify-center hidden"
    id="editConsumableItemsModal" role="dialog">
    <div class="fixed inset-0 bg-black opacity-50 modal-backdrop" id="modalBackdropEditConsumableItems"></div>
    <div class="relative z-50 w-full max-w-md p-6 bg-white rounded-lg shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <img src="/Frontend_Code/images/cas_logo.png" alt="CARES logo" class="object-contain w-12 h-12" />
          <span class="text-3xl font-black text-black">Edit Item</span>
        </div>
      </div>
      <form class="space-y-4" id="editConsumableItemsForm">
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="editConsumableItemsId">
            Item ID
          </label>
          <input
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="editConsumableItemsId" name="editConsumableItemsId" type="text" readonly placeholder="Enter item ID" />
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="editConsumableItemsName">
            Name
          </label>
          <input
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="editConsumableItemsName" name="editConsumableItemsName" type="text" placeholder="Enter item name" />
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="editConsumableItemsUnit">
            Unit
          </label>
          <select
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent text-gray-900 placeholder-gray-400"
            id="editConsumableItemsUnit" name="editConsumableItemsUnit" required>
            <option value="" disabled selected class="placeholder-option">
              Select Unit
            </option>
            <!-- Options will be populated dynamically from the database -->
          </select>
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="editConsumableItemsLocation">
            Location
          </label>
          <select
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="editConsumableItemsLocation" name="editConsumableItemsLocation">
            <option value="" disabled selected class="placeholder-option">
              Select Location
            </option>
            <!-- Options will be populated dynamically from the database -->
          </select>
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="editConsumableItemsBrand">
            Brand
          </label>
          <input
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="editConsumableItemsBrand" name="editConsumableItemsBrand" type="text" placeholder="Enter brand" />
        </div>

        <div class="flex justify-end pt-4 space-x-3">
          <button
            class="px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-[#2ca14a]"
            id="cancelEditBtn" type="button">
            Cancel
          </button>
          <button
            class="px-4 py-2 rounded-md bg-[#2dc653] text-white font-semibold hover:bg-[#27b04a] focus:outline-none focus:ring-2 focus:ring-[#27b04a]"
            type="submit">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- End of Edit Modal -->

  <!-- Add Modal -->
  <div aria-labelledby="modalTitle" aria-modal="true" class="fixed inset-0 z-50 items-center justify-center hidden"
    id="addConsumableItemsModal" role="dialog">
    <div class="fixed inset-0 bg-black opacity-50 modal-backdrop" id="modalBackdropConsumableItems"></div>
    <div class="relative z-50 w-full max-w-md p-6 bg-white rounded-lg shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <img src="/Frontend_Code/images/cas_logo.png" alt="CARES logo" class="object-contain w-12 h-12" />
          <span class="text-3xl font-black text-black">Add Item</span>
        </div>
        <button type="button" aria-label="Close" id="closeAddConsumableItemsModalBtn"
          class="text-3xl font-light text-black hover:text-gray-600 focus:outline-none">
          &times;
        </button>
      </div>
      <form class="space-y-4" id="addConsumableItemsForm">
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="consumableItemsName">
            Name <span class="text-red-500">*</span>
          </label>
          <input
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="consumableItemsName" name="consumableItemsName" required="" type="text"
            placeholder="e.g. Consumable Item Name" />
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="consumableItemsUnit">
            Unit <span class="text-red-500">*</span>
          </label>
          <select
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent text-gray-900 placeholder-gray-400"
            id="consumableItemsUnit" name="consumableItemsUnit" required>
            <option value="" disabled selected class="placeholder-option">
              Select Unit
            </option>
            <!-- Options will be populated dynamically from the database -->
          </select>
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="consumableItemsLocation">
            Location <span class="text-red-500">*</span>
          </label>
          <select
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent custom-select"
            id="consumableItemsLocation" name="consumableItemsLocation" required>
            <option value="" disabled selected class="placeholder-option">
              Select Location
            </option>
            <!-- Options will be populated dynamically from the database -->
          </select>
        </div>
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="consumableItemsBrand">
            Brand <span class="text-red-500">*</span>
          </label>
          <input
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="consumableItemsBrand" name="consumableItemsBrand" required="" type="text"
            placeholder="e.g. Brand Name" />
        </div>
        <div class="flex justify-end pt-4 space-x-3">
          <button
            class="px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-[#2ca14a]"
            id="cancelConsumableItemsBtn" type="button">
            Cancel
          </button>
          <button
            class="px-4 py-2 rounded-md bg-[#2dc653] text-white font-semibold hover:bg-[#27b04a] focus:outline-none focus:ring-2 focus:ring-[#27b04a]"
            type="submit">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- End of Add Modal -->

  <!-- Add Remarks Modal -->
  <div aria-labelledby="remarksModalTitle" aria-modal="true"
    class="fixed inset-0 z-50 items-center justify-center hidden" id="remarksModal" role="dialog">
    <div class="fixed inset-0 bg-black opacity-50 modal-backdrop" id="modalBackdropRemarks"></div>
    <div class="relative z-50 w-full max-w-md p-6 bg-white rounded-lg shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <img src="/Frontend_Code/images/cas_logo.png" alt="CARES logo" class="object-contain w-12 h-12" />
          <span class="text-3xl font-black text-black">Add Remarks</span>
        </div>
      </div>
      <form class="space-y-4" id="remarksForm">
        <input type="hidden" id="remarksConsumableItemsId" name="remarksConsumableItemsId" />
        <div>
          <label class="block mb-1 text-sm font-medium text-gray-700" for="remarksText">
            Remarks
          </label>
          <textarea
            class="w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ca14a] focus:border-transparent"
            id="remarksText" name="remarksText" rows="4" placeholder="e.g. This item is ready for use."></textarea>
        </div>
        <div class="flex justify-end pt-4 space-x-3">
          <button
            class="px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-[#2ca14a]"
            id="cancelRemarksBtn" type="button">
            Cancel
          </button>
          <button
            class="px-4 py-2 rounded-md bg-[#2dc653] text-white font-semibold hover:bg-[#27b04a] focus:outline-none focus:ring-2 focus:ring-[#27b04a]"
            type="submit">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- End of Add Remarks Modal -->

  <!-- Delete Item Modal -->
  <div aria-labelledby="deleteConsumableItemsModal" aria-modal="true"
    class="fixed inset-0 z-50 items-center justify-center hidden" id="deleteConsumableItemsModal" role="dialog">
    <div class="fixed inset-0 bg-black opacity-50 modal-backdrop" id="modalBackdropDeleteConsumableItems"></div>
    <div class="relative z-50 w-full max-w-md p-6 bg-white rounded-lg shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
          <img src="/Frontend_Code/images/cas_logo.png" alt="CARES logo" class="object-contain w-12 h-12" />
          <span class="text-3xl font-black text-black">Delete Item</span>
        </div>
      </div>
      <p class="mb-6 txxt-gray-700">
        Are you sure you want to delete this item? This action cannot be
        undone.
      </p>
      <div class="flex justify-end space-x-3">
        <button
          class="px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-[#2ca14a]"
          id="cancelDeleteConsumableItemsBtn" type="button">
          Cancel
        </button>
        <button
          class="px-4 py-2 font-semibold text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"
          id="confirmDeleteConsumableItemsBtn" type="button">
          Delete
        </button>
      </div>
    </div>
  </div>
  <!-- End of Delete Item Modal -->


  <!-- Date Input Modal for PDF -->
  <div id="dateInputModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 hidden">
    <div class="bg-white rounded-lg shadow-lg p-8 w-full max-w-md">
      <h3 class="text-xl font-bold mb-4 text-center text-green-700">Inventory Report Dates</h3>
      <form id="dateInputForm" class="space-y-4">
        <div id="dateFields" class="space-y-3">
          <div class="flex items-center gap-2">
            <label class="block text-gray-700 font-medium" for="dateField0">Date 1:</label>
            <input type="date" id="dateField0" class="date-input flex-1 border rounded px-3 py-2" required />
          </div>
        </div>
        <div class="flex justify-between mt-2">
          <button type="button" id="addDateField" class="text-green-700 font-semibold">+ Add Date</button>
          <button type="button" id="removeDateField" class="text-red-600 font-semibold">- Remove</button>
        </div>
        <div class="flex justify-end gap-2 mt-4">
          <button type="button" id="cancelDateInput"
            class="px-3 py-1.5 rounded border border-gray-300 text-gray-700 bg-white hover:bg-gray-100">Cancel</button>
          <button type="submit"
            class="px-4 py-1.5 rounded bg-green-600 text-white font-semibold hover:bg-green-700">Generate PDF</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.7.0/jspdf.plugin.autotable.min.js"></script>
  <script src="/Frontend_Code/js/font/Old London-normal.js"></script>

  <!-- Initialize jsPDF -->
  <script>
    window.jsPDF = window.jspdf.jsPDF;
  </script>

  <script type="module" src="/Frontend_Code/js/items.js"></script>
</body>

</html>